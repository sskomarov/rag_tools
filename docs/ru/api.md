# API

В этом разделе описаны все энпоинты, их методы, форматы запросов и ответов.

---
1. `/health` — Проверка статуса сервера
    * **Метод:** `GET`
    * **Описание:** Проверяет доступность API и возвращает статус.
    * **Пример запроса:**
    ```bash
    curl -X GET "http://127.0.0.1:8000/health"
    ```
    * **Пример ответа:**
    ```json
    {
      "status": "ok"
    }
    ```
2. `/metrics/llm` — Метрики LLM
    * **Метод:** `POST`
    * **Описание:** Вычисляет базовые и внешние метрики для текста, сгенерированного моделью.
    * **Пример запроса:**
    ```bash
    curl -X POST "http://127.0.0.1:8000/metrics/llm" \
    -H "Content-Type: application/json" \
    -d '{"reference": "эталонный ответ", "candidate": "сгенерированный ответ"}'
    ```
    * **Пример тела запроса:**
    ```json
    {
      "reference": "эталонный ответ",
      "candidate": "сгенерированный ответ"
    }
    ```
    * **Пример ответа:**
    ```json
    {
      "metrics": {
        "exact_match": false,
        "token_f1": 0.75,
        "len_reference": 21,
        "len_candidate": 25
      }
    }
    ```
3. `/metrics/rag` — Метрики RAG
    * **Метод:** `POST`
    * **Описание:** Вычисляет метрики качества ретривера для предсказаний.
    * **Пример запроса:**
    ```bash
    curl -X POST "http://127.0.0.1:8000/metrics/rag" \
    -H "Content-Type: application/json" \
    -d '{"relevant": [[1, 2]],"predicted": [[2, 3]],"k": 1}'
    ```
    * **Пример тела запроса:**
    ```json
    {
      "relevant": [[1, 2]],
      "predicted": [[2, 3]],
      "k": 1
    }
    ```
    * **Пример ответа:**
    ```json
    {
      "k": 1,
      "metrics": {
        "hit@1": 1.0,
        "mrr": 1.0,
        "n_questions": 1
      }
    }
    ```